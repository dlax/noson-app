#!/bin/sh

MYROOT=''
# Check for an instance of AppImage
if [ -n "$APPDIR" ] && [ -d "$APPDIR@PLUGINS_DIR@" ]; then
  MYROOT="$APPDIR"
fi

# Launch the CLI else the GUI
[ "--cli" = "$1" ] && shift && exec "$MYROOT@NOSON_CLI@" $@

# Migrate the GUI settings
if [ -f "$HOME/.config/janbar/noson.conf" ]; then
  mv "$HOME/.config/janbar/noson.conf" "$HOME/.config/janbar/io.github.janbar.noson.conf"
  [ -d "$HOME/.local/share/janbar/noson" ] && mv "$HOME/.local/share/janbar/noson" "$HOME/.local/share/janbar/io.github.janbar.noson"
  [ -d "$HOME/.cache/janbar/noson" ] && mv "$HOME/.cache/janbar/noson" "$HOME/.cache/janbar/io.github.janbar.noson"
fi

# Launch the GUI
export QML2_IMPORT_PATH="$MYROOT@PLUGINS_DIR@"
exec "$MYROOT@NOSON_GUI@" $@
